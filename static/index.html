<!doctype html>
<head>

     <meta charset="UTF-8">
	 <link rel="stylesheet" href="stylesheet.css">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>COVID-19 Anonymous Notifer | Let's be safe and private</title>
 
     <meta charset="utf-8">
     <meta name="description" content="Notify people you've been in contact with if you've tested positive to COVID-19 (Coronavirus). All of the safety with none of the stigma.">
     <meta name="keywords" content="Coronavirus,COVID-19,Health,Safety,Privacy,Anonymous,STD,STI,Disease,Infection,Endemic,Pandemic,Epidemic,2019,2020">
     <meta name="author" content="Shaunak Gadkari">
     <meta name="creator" content="Shaunak Gadkari">
     <meta name="creator" content="Abinash Ram Sunthar">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta name="color" content="#485a78">
     <meta name="color-scheme" content="only light">

</head>

<div class="box">

    <form method="GET" action="/api/dummy">
        <span class="box-title-text">COVID-19 Anonymous Reporting Tool</span>
        <span class="box-desc-text">Notify people you've been in contact with if you've tested positive to COVID-19 (Coronavirus).</span>
        <span id="emails-container" class="emails-container"></span>
        <div class="input-container">		
            <input type="text" id="emails-input" autocomplete="email">
            <input type="hidden" id="hidden-emails" name="emails" required>
            <label>Email of recipients (comma after each)</label>
        </div>
        <center><button type="submit" class="submit-btn">Send email to recipients</button></center>
    </form>	

</div>

<script>

var e_in = document.getElementById("emails-input");
var e_container = document.getElementById("emails-container");
var hidden_emails = document.getElementById('hidden-emails');
var current_email = 0;
var all_emails = [];
var last_email;

e_in.oninput = function (e) {
    if (this.value.substr(this.value.length - 1) == ",") {

        e_container.innerHTML += '<span class="user-email">' + this.value.replace(",","") + "</span>";
        all_emails.push(this.value.replace(",",""));
        last_email = this.value.replace(",","");
        current_email++;
        hidden_emails.value = all_emails.join(",");

        this.value = "";

    }
};

e_in.onkeydown = function (e) {

    if (this.value == "") {

        var key = event.keyCode || event.charCode;
        if( key == 8 && all_emails.length > 0) {
            this.value = all_emails[all_emails.length - 1];
            all_emails.pop();
            // var last_email = all_emails.pop();
            e_container.innerHTML = e_container.innerHTML.replace('<span class="user-email">' + last_email + '</span>', "");
            hidden_emails.value = hidden_emails.value.replace(last_email, "");
            return false;
        }

    }

};

</script>

</html>
